# 强连通分量

有向图的G的强连通分量是一个最大的点集合C，C中任意两点均可达

称$\ G^T\ 为G的转置图，(u,v)属于\ G^T\ 当且仅当(v,u)属于G$

算法伪代码如下

```pseudocode
STRONGLY-CONNECTED-COMPONENTS(G)
在G中运行DFS得到每个点的f值
计算G的转置图G*
在G*上按照拓扑序运行DFS，将每次循环得到的深度优先森林作为一个强连通分支
```

### 引理（强连通分量间无回路）：设C和C'为有向图G的两个不同的连通分量，设u、v属于C，u'、v‘属于C'，假定图G包含一条从u到u'到路径，那么G不可能包含一条从v'到v到路径

证明：因为C和C'是强连通分支，所以存在u到v到路径和u'到v'的路径，有题设得存在u到u'的路径，假设存在v'到v'到路径，则u与u'之间可以相互到达，与C和C'是两个连通分支矛盾

### 定义：

点集U的d值是U中所有点d的最小值，U的f值是U中所有f的最大值。

### 引理（连通分量间f的关系）：设C和C'是两个不同的连通分量，假如存在一条边(u,v)，u属于C，v属于C'，则有 f(C)>f(C')

证明：当d(C)<d(C')即先发现C中的点时，假设x为C中最早被发现的点，在这一时刻，C与C'中的点都是白色的。因此对于C中任意一点y，都有x到y的一条白色路径，对于C'中任意一点z，也都有x到z的一条白色路径x\~u-v\~z，根据白色路径定理，C和C'中的所有节点都成为x的子节点，根据括号化定理得，f(C) = x.f > f(C')；当d(C')<d(C)时即先发现C'中的点时，设最先发现的点为x，则x到C'中到任意一点都有一条白色路径，因为存在C到C'的边(u,v)，根据强连通分量间无回路引理，一定不存在C‘到C的路径，所以在x处理完毕时，C中的节点都是白色。因为f值是单调递增的，设y是C中最早发现的点，有f(C') = x.f < y.d < y.f = f(C)。

### 推论（强连通分量在转置图上f的关系）：设C和C'为有向图G的两个不同的连通分量，假如存在一条边(u,v)属于G的转置G*，且u属于C，v属于C'，则有f(C)<f(C')

证明：由于(u,v)属于G*，则(v,u)属于G，且G和G'的连通分量相同，由上一条引理可得推论成立

### 定理：SCC算法能够计算出有向图G的强连通分量

证明：使用归纳法。假设算法生成的前k棵树都是强连通分量。在k = 0时，显然成立。

假设前k棵树都是强连通分量，对于第k+1棵树，设跟节点为u，u处于强连通分量C中，对于C以外且没有被访问过的强连通分量C'来说，有u.f = f(C) > f(C')，根据强连通分量在转置图上的关系得，在图G*上不存在C到C'到边，而对于存在到其他连通分量C\*的边情况，同样有f(C)<f(C\*)，这说明C\*已经被搜索过，在这两种情况下，u均不会加入C'，C\*中的任何节点。所以以u为根节点的深度优先树正好形成一个强连通分量。
